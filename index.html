<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lugares Cercanos a Jávea</title>
    <!-- Incluir Axios desde un CDN -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- Incluir el archivo api.js -->
    <script src="api.js"></script>
    <!-- Incluir Material Design 3 desde un CDN -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/material-design-lite/1.3.0/material.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>
<body>
    <h3>Lugares Cercanos a Jávea</h3>
    <button  id="obtenerUbicacion" class="md3-button md3-button-filled">ubicación</button>
    <div class="container" id="resultados"></div>

    <script>
        async function mostrarLugaresCercanos() {
    const ciudad = ""; // Asigna aquí el valor de la ciudad o déjalo vacío si no hay una ciudad específica

    let lat, lon;

    if (ciudad) {
        // Si 'ciudad' tiene un valor, obtener sus coordenadas
        try {
            const coordenadas = await obtenerCoordenadas(ciudad);
            lat = coordenadas.lat;
            lon = coordenadas.lon;
        } catch (error) {
            console.error(`Error al obtener coordenadas de la ciudad: ${error.message}`);
            return; // Salir de la función si ocurre un error
        }
    } else {
        // Si 'ciudad' está vacía, obtener la geolocalización del usuario
        try {
            const posicion = await getGeolocalizacion();
            lat = posicion.lat;
            lon = posicion.lon;
        } catch (error) {
            console.error(`Error al obtener la geolocalización del usuario: ${error.message}`);
            return; // Salir de la función si ocurre un error
        }
    }

    // Si se han obtenido 'lat' y 'lon', buscar lugares cercanos
    if (lat !== undefined && lon !== undefined) {
        try {
            const lugares = await buscarLugaresCercanos(lat, lon);
            const resultadosDiv = document.getElementById('resultados');
            resultadosDiv.innerHTML = '';

            for (const lugar of lugares) {
                const titulo = lugar.title || 'Desconocido';
                const { extracto, miniatura } = await obtenerExtractoWikipedia(titulo);
                const urlArticulo = `https://es.wikipedia.org/wiki/${encodeURIComponent(titulo)}`;
                const lugarCard = document.createElement('a');
                lugarCard.href = urlArticulo;
                lugarCard.target = '_blank';
                lugarCard.className = 'card';
                lugarCard.innerHTML = `
                    <img src="${miniatura}" alt="${titulo}">
                    <div class="card-content">
                        <h2 class="card-title">${titulo}</h2>
                        <p class="card-text">${extracto.split(' ').slice(0, 100).join(' ')}...</p>
                    </div>
                `;
                resultadosDiv.appendChild(lugarCard);
            }
        } catch (error) {
            console.error(`Error al buscar lugares cercanos: ${error.message}`);
        }
    }
        }

        // Llamar a la función para mostrar los lugares cercanos al cargar la página
        document.addEventListener('DOMContentLoaded', mostrarLugaresCercanos);
    </script>



    <script>
    document.getElementById('obtenerUbicacion').addEventListener('click', getGeolocalizacion)

 
    </script>

</body>
</html>
